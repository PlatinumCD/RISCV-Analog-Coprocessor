# Image Args
ARG DOCKERHUB_USER
ARG RELEASE
ARG LLVM_RISCV_MUSL_IMAGE_NAME
ARG SST_CROSSSIM_IMAGE_NAME

FROM ${DOCKERHUB_USER}/${LLVM_RISCV_MUSL_IMAGE_NAME}:${RELEASE} as compiler_stage
FROM ${DOCKERHUB_USER}/${SST_CROSSSIM_IMAGE_NAME}:${RELEASE}

ARG BUILD_SRC
ARG BUILD_DEST

COPY --from=compiler_stage ${BUILD_SRC} ${BUILD_SRC}
COPY --from=compiler_stage ${BUILD_DEST} ${BUILD_DEST}

RUN apt update -y && \
    apt install -y vim

ENV PATH="${PATH}:${BUILD_DEST}/llvm/bin"
ENV BUILD_SRC=${BUILD_SRC}
ENV BUILD_DEST=${BUILD_DEST}

WORKDIR /local

ADD ./etc/vimrc /root/.vimrc
